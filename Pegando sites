!pip install pandas
!pip install googlesearch-python
import pandas as pd
from googlesearch import search


# Carrega o arquivo Excel
df = pd.read_excel('yourFile.xlsx')

# Cria uma nova coluna para armazenar as URLs dos sites
df['URL do Site'] = ''

#confira se seu Data frame realmente está organizado e as colunas no lugar correto
df.head()

# No momento de realizar a pesquisa o Google pode se confundir e capturar o site da empresa errada,
para isto vamos definir um campo de busca através de palavras-chave.

palavras_chave = ['fiber-optics internet']

# Itera pelas empresas na coluna 'Nome da Empresa'
for i, empresa in enumerate(df['Nome da Empresa']):
    print(f'Pesquisando site da empresa {empresa}...')

    # Faz a pesquisa no Google adicionando as palavras-chave
    query = f'{empresa} {"|".join(palavras_chave)} site'
    for j, url in enumerate(search(query, num_results=1)):
        # Copia a primeira URL encontrada para a coluna 'URL do Site'
        df.at[i, 'URL do Site'] = url
        print(f'Site encontrado: {url}')
        break
        
# Confira novamente seu DataFrame
df.head()

# Salve o resultado em um novo arquivo Excel
df.to_excel('empresas_com_urls.xlsx', index=False)
print('Arquivo salvo com as URLs dos sites encontrados.')
